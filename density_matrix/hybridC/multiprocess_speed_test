from multiprocessing import Process, Queue, Pipe
from time import sleep, time
# import logging

def writer_function(pipe, a_value):
    timing = 1.0/(a_value+1)*2
    sleep(timing)
    p_output, p_input = pipe
    p_output.close()  # Do not need to receive stufff
    p_input.send(str(a_value)+' '+str(timing))


def reader_function(pipe):
    pout, pin = pipe
    pin.close()
    msg = pout.recv()
    print time(), msg
    # logging.debug(msg)


if __name__ == '__main__':
    queue_timeout = 2  # how many seconds to wait for a que to finish
    pipe = 4*[None]
    p = 4*[None]
    for i in range(4):
        pipe[i] = Pipe()
        p[i] = Process(target=writer_function, args=(pipe[i], i))
        p[i].start()

    for i in range(4):
        p[i].join()
        reader_function(pipe[i])
